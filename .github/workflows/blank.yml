name: Run Azure Login with OpenID Connect
on: [push]

permissions:
      id-token: write
      
jobs: 
  Windows-latest:
      runs-on: windows-latest
      steps:
        - name: OIDC Login to Azure Public Cloud with AzPowershell (enableAzPSSession true)
          uses: azure/login@v1
          with:
            # oidc-demo
            client-id: "34683a38-41fd-4a6c-b9d1-daf72809fc62"
            # johntericksonlive.onmicrosoft.com
            tenant-id: "6175198f-8863-49c8-ad4a-3ce4364763a8"
            # Visual Studio Enterprise Subscription
            subscription-id: "dcd6a152-f532-4435-9f36-f5b2c5c14939"
            enable-AzPSSession: true

        - name: 'Get resource group with PowerShell action'
          uses: azure/powershell@v1
          with:
             azPSVersion: "latest"
             inlineScript: |
               Get-AzResourceGroup
             
        - name: 'Run Azure CLI commands'
          run: |
            az account show
            az group list
            pwd 
